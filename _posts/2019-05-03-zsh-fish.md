---
title: From bash to zsh and to fish
tags: [Shell, Zsh, Fish, Chinese]
style: fill
color: dark
description: 從bash到zsh再到fish
---

## 從bash到zsh

雖然我使用`zsh`兩週後就換到`fish`了（關於`fish`下面有專門介紹），
但這並不否認`zsh`仍然是個很好的shell。
你可以通過下面的方式從任意的`shell`轉移到`zsh`。

* 安裝`zsh`時通過下面的指令：

```sh
brew install zsh (MacOS)
apt install zsh (Ubuntu / Linux Mint)
```

* 如果你想要知道現在系統裡已經安裝好的`shell`，輸入下面的指令：

```sh
cat /etc/shells
```

* 如何将`zsh`作为你默认的`shell`呢？，输入下面的指令：

```sh
chsh -s /usr/local/bin/zsh
```

* 配置文件读取错误如何差错

shell 脚本解释出错时可以查看一下 sh 的情况：
（例如是否 sh 指定到了 dash 等）

```sh
ls -l `which sh`
```

* 脚本解释器在语法上的不同点

从传统的 bash 等 shell 切换到 zsh 时
会发现集合的第一个元素是从 1 开始的，
如果需要从 0 开始，通过下面的方式即可：

* Fix array index for ZSH:

```sh
if [ "$ZSH_NAME" = "zsh" ];then
	setopt localoptions ksharrays
fi
```

#### 使用zsh

需在你的用户目录下写一个 `.zshrc` 的配置文件，
类似 bash 的 `.bashrc` 配置文件的作用。

我写好的配置上传在了 Github，有需要的可以使用：
[点击查看我的配置](https://github.com/xinii/xinconfig/blob/master/profile/core/zsh.sh)

（未完待续）

## 從zsh到fish

使用`zsh`之後大概兩週我就換到`fish`環境了，
這不是因為`zsh`不好，而是`fish`天然的完成度和易用性吸引了我，
轉移到`fish`環境後，`shell`折騰算是告一段落，以下對該過程紀錄。

#### fish的安裝以及默認shell的切換

這個上面提到過，這裡具體針對不同環境需要執行的指令進行介紹。

* MacOS 环境：

```sh
brew install fish
```

* Ubuntu / Linux Mint 环境：

```sh
apt install fish
```

* OpenSUSE 环境：

```sh
sudo zypper install fish
```

如果需要`root`權限，例如你是運行在Windows下的OpenSUSWE環境，
則默認需要`root`權限，則前面加`sudo`。
通過下面的語句查看當前系統的`shell`：

```
cat /etc/shells
```

如果顯示你的`fish`在`/usr/bin/fish`，
那麼執行下面的語句切換`fish`為默認`shell`（權限不足則補充`sudo`）：

```
chsh -s /usr/bin/fish
```

现在重新打开一个终端会话会发现默认 shell 已经切换到 fish 了。
如果打开 fish shell 马上报很多关于 hostname 的错，
需要使用当前 Linux 发行版的包管理器安装 hostname，
例如在 OpenSUSE 环境下出现类似错误时运行：

```
sudo zypper install hostname
```

即环境下默认缺少 hostname 时，安装即可。

#### fish 的配置

我写好的配置上传在了 Github，有需要的可以使用：
[点击查看我的配置](https://github.com/xinii/xinconfig/tree/master/profile/fish)

#### 在 fish 下使用 python 时的常见问题

目前我遇到的比较需要注意的问题主要有以下两点：

- 关于 tmux

tmux 在后台存在 session 时，即使更新 PYTHONPATH 环境变量也不生效，
此时需要关闭 tmux 所有进程，更改才会生效。

（该问题除 fish 以外应该也会遇到，需要注意）

- 关于 PYTHONPATH

fish 定义环境变量的方式为 `set <变量名> <变量值1> <变量值2>` 的方式，
这种方式有很大的优越性并且十分方便，
但是对于 PYTHONPATH，最好使用 `set PYTHONPATH <变量值1>:<变量值2>` 的方式，
经测试，我在 MacOS 下两种方式均正常使用，
而在 Jetson Nano 搭载的 Ubuntu 下只有第二种方式适用。

具体原因还未明确，有可能是操作系统不同的原因，
也有可能是 python 版本不同的原因（版本号相同，但处理器架构不同，故编译方式存在差异）。
